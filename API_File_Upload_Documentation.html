<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ahold-Delhaize DSG File Upload Documentation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #4a4a8a 0%, #3d3d7a 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }
        .header {
            background: linear-gradient(135deg, #4a4a8a 0%, #3d3d7a 100%);
            color: white;
            padding: 30px;
            border-radius: 15px 15px 0 0;
            margin: -30px -30px 30px -30px;
            position: relative;
            overflow: hidden;
        }
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }
        .gk-logo {
            display: inline-flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .gk-logo img {
            width: 50px;
            height: 50px;
            margin-right: 15px;
        }
        h1 {
            color: white;
            border: none;
            padding-bottom: 0;
            margin-bottom: 10px;
            font-size: 28px;
        }
        h2 {
            color: #4a4a8a;
            margin-top: 40px;
            margin-bottom: 20px;
            border-left: 4px solid #4a4a8a;
            padding-left: 15px;
        }
        h3 {
            color: #3d3d7a;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        .toc {
            background: linear-gradient(135deg, #f8f9ff 0%, #e8e9f5 100%);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #d0d1e0;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc li {
            margin: 8px 0;
        }
        .toc a {
            color: #4a4a8a;
            text-decoration: none;
            font-weight: 500;
        }
        .toc a:hover {
            text-decoration: underline;
            color: #3d3d7a;
        }
        pre {
            background: linear-gradient(135deg, #2c2c4a 0%, #1a1a3a 100%);
            color: #e8e9f5;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
            border: 1px solid #4a4a8a;
        }
        code {
            background: #f0f0f8;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #4a4a8a;
            border: 1px solid #d0d1e0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }
        th, td {
            border: 1px solid #bdc3c7;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        .note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
        }
        .warning {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
        }
        .endpoint {
            background: #e8f5e8;
            border-left: 4px solid #27ae60;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
        }
        .method-post {
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .step {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .step-number {
            background: #3498db;
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="gk-logo">
                <img src="https://upload.wikimedia.org/wikipedia/commons/7/76/GK-Logo-400x400.png" alt="GK Software Logo">
                <span style="font-size: 36px; font-weight: bold; color: white;">GK Software</span>
            </div>
            <h1>üöÄ Ahold-Delhaize DSG File Upload Documentation</h1>
            <p><strong>GK Software DSG - Image Upload Guide</strong></p>
        </div>

        <h3>üìã Document Information</h3>
        <table>
            <thead>
                <tr>
                    <th>Property</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Version</strong></td>
                    <td>Initial Version</td>
                </tr>
                <tr>
                    <td><strong>Author</strong></td>
                    <td>M. Penkava</td>
                </tr>
                <tr>
                    <td><strong>Environment</strong></td>
                    <td>Test (test.ahd.cloud4retail.co)</td>
                </tr>
            </tbody>
        </table>

        <div class="toc">
            <h3>üìã Table of Contents</h3>
            <ul>
                <li><a href="#webdav-upload">üìÅ WebDAV Upload (Recommended)</a></li>
                <li><a href="#authentication">üîê API Authentication</a></li>
                <li><a href="#file-upload">üì§ API File Upload</a></li>
                <li><a href="#postman-testing">üß™ Postman Testing</a></li>
                <li><a href="#troubleshooting">üîß Troubleshooting</a></li>
            </ul>
        </div>

        <h2 id="webdav-upload">üìÅ WebDAV Upload (Recommended)</h2>

        <p>WebDAV is the recommended method for file uploads. It provides a simple file system interface for uploading files.</p>

        <h3>Connection Details</h3>
        <table>
            <thead>
                <tr>
                    <th>Parameter</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Protocol</strong></td>
                    <td>WebDAV</td>
                </tr>
                <tr>
                    <td><strong>Host</strong></td>
                    <td>test.ahd.cloud4retail.co</td>
                </tr>
                <tr>
                    <td><strong>Port</strong></td>
                    <td>443 (HTTPS)</td>
                </tr>
                <tr>
                    <td><strong>Context Path</strong></td>
                    <td>/dsg/webdav</td>
                </tr>
                <tr>
                    <td><strong>Username</strong></td>
                    <td>admin</td>
                </tr>
                <tr>
                    <td><strong>Password</strong></td>
                    <td>CbPwmowKYQbhUJ4hfJ2O</td>
                </tr>
                <tr>
                    <td><strong>Encryption</strong></td>
                    <td>TLS/SSL Implicit encryption</td>
                </tr>
            </tbody>
        </table>

        <h3>WebDAV Client Setup</h3>

        <h4>Using WinSCP (Windows)</h4>
        <div class="step">
            <span class="step-number">1</span>
            <strong>Create New Site</strong>
            <ul>
                <li>File protocol: <code>WebDAV</code></li>
                <li>Host name: <code>test.ahd.cloud4retail.co</code></li>
                <li>Port number: <code>443</code></li>
                <li>User name: <code>admin</code></li>
                <li>Password: <code>CbPwmowKYQbhUJ4hfJ2O</code></li>
                <li>Encryption: <code>TLS/SSL Implicit encryption</code></li>
            </ul>
        </div>

        <div class="step">
            <span class="step-number">2</span>
            <strong>Advanced Settings</strong>
            <ul>
                <li>Set remote directory to: <code>/dsg/webdav</code></li>
            </ul>
        </div>

        <div class="step">
            <span class="step-number">3</span>
            <strong>Connect and Upload</strong>
            <ul>
                <li>Click "Login" to connect</li>
                <li>Navigate to the appropriate folder structure</li>
                <li>Drag and drop files or use the upload interface</li>
            </ul>
        </div>

        <h4>Using Other WebDAV Clients</h4>
        <div class="note">
            <strong>üìù WebDAV URL:</strong> <code>https://test.ahd.cloud4retail.co/dsg/webdav</code>
            <br><br>
            Most WebDAV clients can connect using this URL with the credentials above.
        </div>

        <h4>Command Line (curl)</h4>

        <h5>Linux/Mac:</h5>
        <pre># Upload a file via WebDAV
curl -T "/path/to/your/image.png" \
--user "admin:CbPwmowKYQbhUJ4hfJ2O" \
--ssl-no-revoke \
"https://test.ahd.cloud4retail.co/dsg/webdav/image/item/image.png"</pre>

        <h5>Windows (PowerShell):</h5>
        <pre># Upload a file via WebDAV
curl.exe -T "C:\path\to\your\image.png" `
--user "admin:CbPwmowKYQbhUJ4hfJ2O" `
--ssl-no-revoke `
"https://test.ahd.cloud4retail.co/dsg/webdav/image/item/image.png"</pre>



        <h2 id="authentication">üîê API Authentication</h2>

        <div class="note">
            <strong>üìù Note:</strong> The API methods below were discovered through analysis via Developer Console in Browser of the GK Employee Hub's network requests. WebDAV remains the recommended method.
        </div>

        <h3>Get Bearer Token</h3>
        <p>Before uploading files via API, you need to obtain a Bearer token for authentication.</p>
        
        <div class="endpoint">
            <span class="method-post">POST</span> https://test.ahd.cloud4retail.co/auth-service/tenants/001/oauth/token
        </div>

        <h4>Method 1: Non-Encoded Basic Auth</h4>
        <pre>curl --location 'https://test.ahd.cloud4retail.co/auth-service/tenants/001/oauth/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--user 'launchpad:1zQbeyL5NdDj5BGTaqo3' \
--data-urlencode 'username=employee_hub_username' \
--data-urlencode 'password=employee_hub_password' \
--data-urlencode 'grant_type=password'</pre>

        <h4>Method 2: Encoded Basic Auth</h4>
        <pre>curl --location 'https://test.ahd.cloud4retail.co/auth-service/tenants/001/oauth/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--header 'Authorization: Basic bGF1bmNocGFkOjF6UWJleUw1TmREajVCR1RhcW8z' \
--data-urlencode 'username=employee_hub_username' \
--data-urlencode 'password=employee_hub_password' \
--data-urlencode 'grant_type=password'</pre>

        <div class="note">
            <strong>üìù Note:</strong> The Basic Auth credentials are:
            <ul>
                <li><strong>Username:</strong> <code>launchpad</code></li>
                <li><strong>Password:</strong> <code>1zQbeyL5NdDj5BGTaqo3</code></li>
                <li><strong>Encoded:</strong> <code>bGF1bmNocGFkOjF6UWJleUw1TmREajVCR1RhcW8z</code></li>
            </ul>
        </div>

        <h4>Response Format</h4>
        <pre>{
  "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIs...",
  "token_type": "bearer",
  "expires_in": 3600,
  "scope": "GK"
}</pre>
        <p>Copy the <code>access_token</code> value for use in file upload requests.</p>

        <h2 id="file-upload">üì§ API File Upload</h2>
        
        <div class="endpoint">
            <span class="method-post">POST</span> https://test.ahd.cloud4retail.co/dsg/services/rest/media/v1/files/image/item/{filename}
        </div>

        <h3>Upload Image File</h3>
        <pre>curl --location 'https://test.ahd.cloud4retail.co/dsg/services/rest/media/v1/files/image/item/test_img.PNG' \
--header 'accept: */*' \
--header 'authorization: Bearer YOUR_ACCESS_TOKEN_HERE' \
--header 'gk-accept-redirect: 308' \
--form 'content=@"/path/to/your/image.png";type=image/png'</pre>

        <h3>Parameters Explanation</h3>
        <table>
            <thead>
                <tr>
                    <th>Parameter</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>URL</code></td>
                    <td>The endpoint URL with the target filename</td>
                </tr>
                <tr>
                    <td><code>accept: */*</code></td>
                    <td>Accept any response content type</td>
                </tr>
                <tr>
                    <td><code>authorization: Bearer</code></td>
                    <td>Your access token from authentication</td>
                </tr>
                <tr>
                    <td><code>gk-accept-redirect: 308</code></td>
                    <td>Custom header for GK API redirect handling</td>
                </tr>
                <tr>
                    <td><code>content=@"filepath"</code></td>
                    <td>The file to upload (@ prefix for file path)</td>
                </tr>
                <tr>
                    <td><code>type=image/png</code></td>
                    <td>Explicitly set the MIME type</td>
                </tr>
            </tbody>
        </table>

        <h3>Supported File Types</h3>
        <p>Mainly supported image types:</p>
        <ul>
            <li><code>image/png</code> (.png)</li>
            <li><code>image/jpeg</code> (.jpg)</li>
        </ul>

        <h3>Examples with Different File Types</h3>

        <h4>PNG File:</h4>
        <pre>--form 'content=@"/path/to/image.png";type=image/png'</pre>

        <h4>JPEG File:</h4>
        <pre>--form 'content=@"/path/to/image.jpg";type=image/jpeg'</pre>

        <h2 id="postman-testing">üß™ Postman Testing</h2>
        
        <h3>Setup Steps</h3>
        
        <div class="step">
            <span class="step-number">1</span>
            <strong>Create New Request</strong>
            <ul>
                <li>Method: <code>POST</code></li>
                <li>URL: <code>https://test.ahd.cloud4retail.co/dsg/services/rest/media/v1/files/image/item/your_filename.png</code></li>
            </ul>
        </div>

        <div class="step">
            <span class="step-number">2</span>
            <strong>Headers Tab</strong>
            <pre>Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
accept: */*
gk-accept-redirect: 308</pre>
            <div class="warning">
                <strong>‚ö†Ô∏è Important:</strong> Do NOT add <code>Content-Type</code> header manually - Postman handles this automatically for form-data.
            </div>
        </div>

        <div class="step">
            <span class="step-number">3</span>
            <strong>Body Tab</strong>
            <ul>
                <li>Select <strong>form-data</strong></li>
                <li>Add key: <code>content</code></li>
                <li>Change type from "Text" to <strong>"File"</strong></li>
                <li>Select your image file</li>
            </ul>
        </div>

        <div class="step">
            <span class="step-number">4</span>
            <strong>Send Request</strong>
        </div>

        <h3>Expected Responses</h3>

        <div class="success">
            <strong>‚úÖ Success (201 Created):</strong> File uploaded successfully.
        </div>

        <div class="warning">
            <strong>‚ùå Known Error (415 - Unsupported Media Type):</strong>
            <pre>{
  "message": "Resource (, application/octet-stream) was rejected by input/accept filter",
  "timestamp": "2025-07-24T17:47:26.641+0000",
  "status": 415,
  "url": "https://test.ahd.cloud4retail.co/dsg/services/rest/media/v1/files/image/item/test_img.PNG"
}</pre>
        </div>



        <h2 id="troubleshooting">üîß Troubleshooting</h2>
        
        <h3>Common Issues</h3>

        <table>
            <thead>
                <tr>
                    <th>Error</th>
                    <th>Cause</th>
                    <th>Solution</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>415 Unsupported Media Type</strong></td>
                    <td>File sent as <code>application/octet-stream</code> instead of proper image MIME type</td>
                    <td>Explicitly specify the content type: <code>;type=image/png</code></td>
                </tr>
                <tr>
                    <td><strong>401 Unauthorized</strong></td>
                    <td>Invalid or expired Bearer token</td>
                    <td>Get a new access token using the authentication endpoint</td>
                </tr>
                <tr>
                    <td><strong>Other HTTP errors</strong></td>
                    <td>Various API-specific issues</td>
                    <td>Check response body for specific error details</td>
                </tr>
            </tbody>
        </table>

        <h3>Debug Tips</h3>
        <ul>
            <li><strong>Check token expiration:</strong> JWT tokens expire (check the <code>exp</code> field in the token)</li>
            <li><strong>Verify file path:</strong> Ensure the file exists and path is correct</li>
            <li><strong>Test with Postman first:</strong> Easier to debug than command line</li>
            <li><strong>Verify MIME type:</strong> Use <code>file --mime-type filename</code> to check actual file type</li>
            <li><strong>Check response details:</strong> Always examine the full response body for error details</li>
        </ul>

        <h3>Token Expiration</h3>
        <p>Bearer tokens are valid for 1 hour. If you get 401 errors, obtain a new token using the authentication methods above.</p>


    </div>
</body>
</html>
